# ☁️ 微信云开发迁移指南

恭喜！代码迁移已自动完成。请按照以下步骤完成最后配置，即可立即上线！

## 1. 开通云开发 (如果未开通)
1. 在微信开发者工具工具栏，点击 **“云开发”** 按钮。
2. 如果未开通，请点击 **“开通”**，创建一个新环境（推荐选择按量付费，有免费额度）。
3. 记住您的 **环境 ID** (Environment ID)。

## 2. 创建数据库集合
请在“云开发控制台” -> **“数据库”** 中，手动创建以下 **5个集合** (Collection)：

- `families`
- `members`
- `tasks`
- `rewards`
- `redemptions`

> **注意**：权限设置建议先设为 **“所有用户可读，仅创建者可读写”** (默认) 或 **“所有用户可读写”** (仅开发调试期)。我们的云函数拥有最高权限（超级管理员），所以前端权限设置不会影响后端逻辑。

## 3. 部署云函数
1. 在开发者工具的文件列表中，找到 `cloudfunctions` 目录。
2. 右键点击 `api` 文件夹。
3. 选择 **“上传并部署：云端安装依赖（不上传 node_modules）”**。
4. 等待部署成功提示。

## 4. 重新编译
1. 点击开发者工具的 **“编译”** 按钮。
2. 观察控制台，如果没有报错，说明迁移成功！

## 5. 验证
- 尝试创建一个新家庭。
- 尝试创建一个任务。
- 如果一切正常，数据将直接存储在云数据库中。

## 常见问题
- **找不到环境ID**：在 `app.js` 中 `wx.cloud.init()` 里，如果不填 `env`，默认使用第一个环境。如果报错，请手动填入您的环境 ID。
- **调用失败**：请检查云函数是否部署成功，以及网络是否正常。
